<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberLog - Blog de Ciberseguridad</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #121212;
      color: #fff;
      margin: 0; padding: 0;
      transition: background 0.3s, color 0.3s;
    }
    .light-mode {
      background-color: #f5f5f5;
      color: #000;
    }
    header, footer {
      background: #1e1e1e;
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
    }
    .light-mode header,
    .light-mode footer {
      background: #ddd;
      color: #000;
    }
    nav ul {
      list-style: none;
      padding: 0;
      margin: 10px 0 0;
      display: flex;
      justify-content: center;
      gap: 1.5em;
      flex-wrap: wrap;
    }
    nav li {
      display: inline;
    }
    nav a {
      color: inherit;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.05em;
      cursor: pointer;
    }
    nav a:hover {
      text-decoration: underline;
    }
    nav a.active {
      text-decoration: underline;
      font-weight: 700;
      color: #00fff0;
    }
    .container {
      max-width: 800px;
      margin: 30px auto;
      padding: 0 20px 40px;
    }
    .blog-entry {
      border: 1px solid #444;
      padding: 20px;
      margin-bottom: 25px;
      border-radius: 10px;
      background-color: #1a1a1a;
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.15);
      transition: background-color 0.3s, border-color 0.3s;
      word-break: break-word;
      position: relative;
    }
    .light-mode .blog-entry {
      border-color: #aaa;
      background-color: #fafafa;
      color: #111;
    }
    button, input, textarea {
      padding: 10px;
      margin: 5px 0;
      border-radius: 6px;
      border: none;
      font-size: 1em;
      font-family: inherit;
    }
    button {
      background-color: #00fff0;
      color: #000;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #00cacc;
    }
    input[type="password"],
    input[type="text"],
    textarea,
    select {
      width: 100%;
      box-sizing: border-box;
      resize: vertical;
      border: 1.5px solid #444;
      background-color: #222;
      color: #eee;
      transition: border-color 0.3s, background-color 0.3s;
    }
    input[type="password"]:focus,
    input[type="text"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #00fff0;
      background-color: #111;
    }
    .admin-panel, #login-form {
      border-top: 2px dashed #00fff0;
      padding-top: 20px;
      margin-top: 40px;
      display: none;
    }
    .spam-warning {
      color: #ff4d4d;
      font-size: 0.9em;
      margin-top: 5px;
      font-weight: 600;
    }
    #toggle-mode {
      position: absolute;
      top: 15px;
      right: 60px;
      background: none;
      border: none;
      color: #00fff0;
      font-size: 1.5em;
      cursor: pointer;
      user-select: none;
      transition: color 0.3s;
    }
    #toggle-mode:hover {
      color: #00cacc;
    }
    #btn-admin-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: #00fff0;
      font-size: 1.5em;
      cursor: pointer;
      user-select: none;
      transition: color 0.3s;
    }
    #btn-admin-toggle:hover {
      color: #00cacc;
    }
    button.delete-post {
      background-color: #ff4d4d;
      color: white;
      font-weight: 700;
      border-radius: 5px;
      padding: 5px 10px;
      font-size: 0.9em;
      position: absolute;
      top: 10px;
      right: 10px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button.delete-post:hover {
      background-color: #cc0000;
    }
  </style>
</head>
<body>
  <header>
    <h1>üõ°Ô∏è CyberLog</h1>
    <h2>üîê Explorando la Seguridad Inform√°tica</h2>
    <p>üíª Aprendiendo a proteger lo que otros no ven</p>
    <p>üß† Observa, analiza, protege.</p>
    <button id="toggle-mode" title="Cambiar modo claro/oscuro">üåô</button>
    <button id="btn-admin-toggle" title="Mostrar/Ocultar panel admin">üîë</button>
    <nav>
      <ul>
        <li><a id="tab-posts" class="active">Publicaciones</a></li>
        <li><a id="tab-news">Noticias</a></li>
      </ul>
    </nav>
  </header>

  <main class="container">
    <section id="posts">
      <!-- Posts o noticias se cargar√°n aqu√≠ -->
    </section>

    <section id="login-form">
      <h3>üîê Acceso de Administrador</h3>
      <input type="password" id="admin-pass" placeholder="Contrase√±a de admin" autocomplete="off" />
      <button onclick="login()">Ingresar</button>
      <p id="login-msg" style="color: #ff4d4d; font-weight: 600;"></p>
    </section>

    <section class="admin-panel" id="admin-panel">
      <h3>üõ† Panel de Administraci√≥n</h3>
      <select id="post-type">
        <option value="post" selected>Publicaci√≥n</option>
        <option value="news">Noticia</option>
      </select>
      <input type="text" id="new-title" placeholder="T√≠tulo del post" maxlength="100" />
      <textarea id="new-content" placeholder="Contenido..." rows="6" maxlength="3000"></textarea>
      <button onclick="addPost()">üì§ Publicar</button>
      <p class="spam-warning" id="spam-warning"></p>
    </section>
  </main>

  <footer class="container">
    <p>&copy; 2025 CyberLog - Seguridad Inform√°tica para Todos</p>
  </footer>

  <script>
    const ADMIN_PASSWORD = "Cyb3rLog!2025#";
    const discordWebhook = "https://discord.com/api/webhooks/ID/WEBHOOK"; // Cambia esta URL por tu webhook real

    const postsContainer = document.getElementById("posts");
    const adminPanel = document.getElementById("admin-panel");
    const loginForm = document.getElementById("login-form");
    const loginMsg = document.getElementById("login-msg");
    const spamWarning = document.getElementById("spam-warning");
    const toggleModeBtn = document.getElementById("toggle-mode");
    const btnAdminToggle = document.getElementById("btn-admin-toggle");

    const tabPosts = document.getElementById("tab-posts");
    const tabNews = document.getElementById("tab-news");

    let isAdmin = false;
    let lastPostTime = 0;
    let posts = [];
    let news = [];
    let currentTab = 'post'; // 'post' o 'news'

    // Carga posts y noticias de localStorage
    function loadData() {
      const savedPosts = localStorage.getItem("cyberlog-posts");
      const savedNews = localStorage.getItem("cyberlog-news");
      posts = savedPosts ? JSON.parse(savedPosts) : [];
      news = savedNews ? JSON.parse(savedNews) : [];
    }

    // Guarda posts y noticias en localStorage
    function saveData() {
      localStorage.setItem("cyberlog-posts", JSON.stringify(posts));
      localStorage.setItem("cyberlog-news", JSON.stringify(news));
    }

    // Escapa HTML para evitar inyecci√≥n
    function escapeHtml(text) {
      return text.replace(/[&<>"']/g, function(m) {
        return {
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;'
        }[m];
      });
    }

    // Renderiza la lista seg√∫n la pesta√±a activa
    function render() {
      postsContainer.innerHTML = "";
      let list = currentTab === 'post' ? posts : news;

      if(list.length === 0){
        postsContainer.innerHTML = `<p>No hay ${currentTab === 'post' ? 'publicaciones' : 'noticias'} a√∫n.</p>`;
        return;
      }

      list.forEach((item, index) => {
        const entry = document.createElement("section");
        entry.className = "blog-entry";
        entry.innerHTML = `
          <h3>${escapeHtml(item.title)}</h3>
          <p>${escapeHtml(item.content).replace(/\n/g, "<br>")}</p>
          ${isAdmin ? `<button class="delete-post" onclick="deleteItem(${index})" title="Eliminar ${currentTab === 'post' ? 'publicaci√≥n' : 'noticia'}">üóëÔ∏è</button>` : ""}
        `;
        postsContainer.appendChild(entry);
      });
    }

    // Login de administrador
    function login() {
      const pass = document.getElementById("admin-pass").value;
      if(pass === ADMIN_PASSWORD){
        isAdmin = true;
        adminPanel.style.display = "block";
        loginForm.style.display = "none";
        loginMsg.textContent = "";
        render();
      } else {
        loginMsg.textContent = "‚ùå Contrase√±a incorrecta";
      }
      document.getElementById("admin-pass").value = "";
    }

    // A√±adir nueva publicaci√≥n o noticia
    function addPost() {
      const now = Date.now();
      if(now - lastPostTime < 10000){
        spamWarning.textContent = "üõë Espera 10 segundos antes de publicar otra vez.";
        return;
      }

      const title = document.getElementById("new-title").value.trim();
      const content = document.getElementById("new-content").value.trim();
      const type = document.getElementById("post-type").value;
      if(!title || !content){
        spamWarning.textContent = "‚ö†Ô∏è Completa t√≠tulo y contenido.";
        return;
      }

      if(type === 'post'){
        posts.unshift({title, content});
      } else {
        news.unshift({title, content});
      }

      saveData();
      render();

      document.getElementById("new-title").value = "";
      document.getElementById("new-content").value = "";
      spamWarning.textContent = "";
      lastPostTime = now;

      // Log en Discord
      fetch(discordWebhook, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
          content: `üì¢ Nuevo ${type === 'post' ? 'post' : 'noticia'} publicado en CyberLog:\n**${title}**\n${content}`
        })
      }).catch(() => console.warn("No se pudo enviar log a Discord."));
    }

    // Eliminar publicaci√≥n o noticia
    function deleteItem(index){
      let list = currentTab === 'post' ? posts : news;
      const title = list[index].title;
      if(!confirm(`¬øEliminar la ${currentTab === 'post' ? 'publicaci√≥n' : 'noticia'} "${title}"?`)) return;

      list.splice(index, 1);
      saveData();
      render();

      // Log en Discord
      fetch(discordWebhook, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
          content: `üóëÔ∏è El admin elimin√≥ la ${currentTab === 'post' ? 'publicaci√≥n' : 'noticia'}: **${title}**`
        })
      }).catch(() => console.warn("No se pudo enviar log a Discord."));
    }

    // Cambio de pesta√±as
    tabPosts.addEventListener("click", () => {
      currentTab = 'post';
      tabPosts.classList.add("active");
      tabNews.classList.remove("active");
      render();
    });

    tabNews.addEventListener("click", () => {
      currentTab = 'news';
      tabNews.classList.add("active");
      tabPosts.classList.remove("active");
      render();
    });

    // Toggle modo oscuro/claro
    toggleModeBtn.addEventListener("click", () => {
      document.body.classList.toggle("light-mode");
      if(document.body.classList.contains("light-mode")){
        toggleModeBtn.textContent = "üåô";
      } else {
        toggleModeBtn.textContent = "‚òÄÔ∏è";
      }
    });

    // Toggle mostrar login/admin con bot√≥n en header
    btnAdminToggle.addEventListener("click", () => {
      if(!isAdmin){
        if(loginForm.style.display === "block"){
          loginForm.style.display = "none";
        } else {
          loginForm.style.display = "block";
          adminPanel.style.display = "none";
          loginMsg.textContent = "";
        }
      } else {
        if(adminPanel.style.display === "block"){
          adminPanel.style.display = "none";
        } else {
          adminPanel.style.display = "block";
          loginForm.style.display = "none";
        }
      }
    });

    // Inicializaci√≥n
    loadData();
    render();

    // Recarga peri√≥dica para que usuarios vean nuevos posts sin recargar p√°gina
    setInterval(() => {
      if (!adminPanel.style.display || adminPanel.style.display === "none") {
        loadData();
        render();
      }
    }, 15000);
  </script>
</body>
</html>
